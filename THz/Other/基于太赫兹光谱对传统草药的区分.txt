摘要
本文采用太赫兹（THz）光谱技术开发了一种区分传统草药的有效方法。在0.2–1.2 THz的范围内获得了三种不同草药的光谱（Herba Solani Lyrati，Herba Solani Nigri和Aristolochiae Mollissimae）。应用主成分分析（PCA）来减少原始光谱信息的维数。使用三种分类算法，支持向量机（SVM），决策树（DT）和随机森林（RF）来区分草药。将接收器工作特性（ROC）曲线和ROC曲线下面积（AUC）与分类精度相结合，以评估三种分类算法的性能。 PCA-RF方法获得了最佳的ROC曲线和AUC，并实现了99％的预测精度。实验结果表明，太赫兹光谱结合化学计量学算法是一种有效，快速的判别方法 传统草药。 

1 。介绍
草药占传统药物的最大部分。在中药中，这一比例达到了87％[1]。在某些传统药典中，相似的名称，相似的外观或错误的记录会导致草药的滥用，并带来医疗安全问题。例如，华山刺槐（Culis Clematidis Armandii）的干燥葡萄藤被称为“川木通”，而满洲里马兜铃（Caulis Aristolochiae Manshuriensis）的干燥葡萄树具有类似的名称-“关木通” [2]。关木通中含有马兜铃酸，可能会损害肾脏。关木通错误地用作川木通可能导致马兜铃酸肾病[3]。外观相似的一个例子是线虫和日本忍冬的混淆图恩 忍冬（Lonicera japonica Thunb）是无毒的，而线虫（Gelsemium elegans）则含有17种有毒成分。许多死亡发生因错误使用断肠草如金银花藤[4] 。为了人们的健康和安全，草药的准确认证至关重要。
传统上，传统草药的鉴别主要取决于形态学的观察[5]，[6] 。这种方法需要有经验的观察者，并依赖于观察者的主观判断。几乎没有获得主观判断的标准。化学分析，分子分析和色谱分析对草药具有客观准确的判别[7]，[8]，[9]，[10]，[11]。然而，这些方法具有耗时且劳动密集的缺点。而且，需要大量的化学试剂或有机溶剂。这需要额外的成本，并且可能导致化学废物的环境污染。有必要发展一种低成本，高精度的快速，高效的环境保护，以区别传统草药。
太赫兹辐射是指微波和红外波段之间的区域中的电磁波，频率为0.1到10 THz（波长30 μm–3mm）。研究表明，太赫兹时域光谱（THz-TDS）是检测生物分子的强大工具，因为大多数生物分子的振动和旋转能级分布在THz谱带中，并可以反映在THz-TDS中。由于具有检测速度快，无损，低成本，省时，无污染的优点，THz-TDS与化学计量学算法一起在安全检测等许多领域中越来越多地使用 [12]，[13] ，农业检测[14]，[15]，生物检测[16]，[17]和医学检测[18]，[19]近年来。在这项工作中，我们将THz-TDS与化学计量学方法相结合来区分传统草药。

2 。材料与方法
2.1 。样品制备
我们获得了三种容易混淆的传统草药（Herba Solani Lyrati，Herba Solani Nigri和Aristolochiae Mollissimae）。索拉尼·莱拉蒂（Herba Solani Lyrati）于三月从中国江苏省获得。索拉尼·尼格里（Herba Solani Nigri）于三月从中国山西省获得。马兜铃科的毛草是三月份从中国河北省获得的。将草药自然干燥，用粉末机粉化并分别通过100目的筛子过滤。为了除去从空气中吸收的水分，将所有粉末在真空干燥箱中于50  °C 干燥2 小时。然后，将干燥的粉末通过液压机在12的压力下压制成圆形片剂。  MPa。每个片剂的厚度，直径和重量为约 1mm， 12mm和180mg  。对于每种草药，准备了400个样品进行测量。
2.2 。实验系统
THz-TDS传输系统由Z-3 THz时域光谱仪（美国Zomega Terahertz Corp.）和飞秒激光器 – FemtoFiber pro NIR（中心波长780 nm ，脉冲宽度100 fs，重复频率80 MHz，140）组成平均功率mW （德国TOPTICA Photonics Inc.）。该系统的示意图在图1中示出。如参考文献中的描述。[20] ，由激光产生的光束被立方分束器（CBS）分为泵浦光束和探测光束。光电导偶极子天线产生太赫兹波     在泵浦光束的照射下并聚焦在样品上。探测光束聚焦到ZnTe晶体上，THz波穿过样品。然后，它们被引导到检测天线。为了避免水对空气的干扰，将设备放置在密闭盒中。直到实验结束，干燥空气一直没有中断地注入箱中，以确保内部相对湿度（RH）小于3％。
2.3 。化学计量学算法
2.3.1 。主成分分析（PCA）
变量太多往往会增加主题的复杂性。由于变量之间可能存在相关性，因此可以认为变量具有一些重叠的信息。PCA用于将一组可能相关的变量转换为一组线性不相关的变量，称为主成分（PC）。PC是正交的，第k个主成分（PCk）占第k个最大可变性。PC的数量小于或等于原始变量的数量。这意味着可以获得较小的尺寸。
2.3.2 。支持向量机（SVM）
Vapnik在1995年提出的SVM是有效的分类工具之一。它广泛用于分析数据和识别模式。SVM的基本思想是识别超平面，以正确地将两个类别彼此分开。具有最大余量的超平面称为最佳超平面，并进行最佳微分。支持向量是指限制边距宽度的点。两类分类问题可以用以下凸优化问题 [21]，[22]的形式表示：
（1）
符合
（2）
这里，正的常数Ç是惩罚因子，ξ 我是松弛变量，该权重向量 ω和的趋势值b限定的最佳超平面。我们的SVM模型中使用了一种常用的内核函数-径向偏差函数（RBF）。由以下公式[23]表示：
（3）
用遗传算法搜索最优罚因子C和最优RBF参数γ。
2.3.3 。决策树（DT，C4.5）
C4.5算法是最流行的决策树决策算法之一。C4.5的主要思想是通过对可能的决策树空间的自上而下的贪婪搜索来构建决策树。增益比在C4.5算法中用作属性选择的标准。它被定义为以下[24]，[25]，[26]：（
4）
拆分信息（S，A）是拆分信息，定义为
（5）
增益（S，A）是信息增益，定义为
（6）
（7）
在这里，V（甲）是属性的范围甲，š υ是集合的子集š其中甲  = υ。 
作为分类器，决策树以树结构的形式构建分类模型。给定一组小号箱子，C4.5第一生长使用分而治之算法的初始树[27] 。如果S中的所有个案都属于同一类别或S小，则树是标记为S中最频繁的类别的叶子。通常，决策树是一种树数据结构，由一个根节点，多个决策节点和叶节点组成。集合 S通过对应于最大增益比的属性被分成越来越小的子集。每个决策节点代表对属性值的测试。它有两个或多个分支，每个分支代表一个测试结果。树的每个叶节点代表一个分类类别。
2.3.4 。随机森林（RF）
随机森林是决策树的集合（第2.3.3节  ）。每棵树都取决于独立采样的随机向量的值，并且对森林中的所有树都具有相同的分布[28]。RF的采样方法基于Bootstrap：从集合中提取替换样本，并重复n次以获得新集合。这种采样方法使RF对噪声或过度训练不敏感[29]。随机森林的应用需要遵循以下步骤：
（1）
通过Bootstrap方法从具有N个样本的训练数据中获得N个训练集。训练集被标记为小号1，小号2，...，小号Ñ。
（2）
从每个节点的特征空间中随机选择m个特征。然后，使用诸如C4.5之类的方法找到最佳的分割特征。
（3）
通过重复步骤（2），为训练集生成决策树。
（4）
通过使用决策树预测测试集的样本，并获得相应的分类。
（5）
RF从所有树木预测中获得平均或多数票，以获得最佳分类。
在步骤3中，需要设置树数。我们将其设置为一个经验值–500。事实证明，泛化误差始终会收敛，并且当增加数字时[30]，[31]不会发生过度训练。
2.3.5 。ROC和AUC
接收器工作特性（ROC）分析始终用于描述一种检测方法的性能，该检测方法通过图形方法来区分2个互斥条件[32]。在分类中，ROC分析是评估样品区分程度的有用工具，因为它可以测量每个类别的正确比率。如表1所示，在两级分类中将获得四个结果。
真实阳性率（TPR）定义为TPR  =  TP /（TP  +  FN），用于测量正确识别的阳性率。误报率（FPR）定义为FPR  =  TN /（FP  +  TN）。这意味着有多少百分比的其他测试样本被错误地分类为真实类别。ROC曲线由TPR（垂直轴）和FPR（水平轴）描述。AUC是指ROC曲线下的面积。它是ROC分析的指标。在0.5–1的范围内，AUC的值越大，分类越好。应该注意的是，如果AUC的值等于1，则所有样本均已正确分类。但是，如果AUC的值不大于0.5，则分类是没有意义的。
2.4 。歧视程序
如图2所示，我们的工作是按照以下过程进行的：
（1）
对于每种草药，从400个样本中随机选择300个样本作为训练集，并从100个样本中随机选择100个样本作为测试集（表2）。（2）
使用THz-TDS获得样品的THz吸收光谱。
（3）
使用PCA进行特征提取和选择。
（4）
创建分类模型以区分草药。
（5）
通过比较准确性，ROC曲线和AUC值来评估分类模型。

3 。结果与讨论
3.1 。草药的太赫兹吸收光谱
图3显示了3种草药在0.2–1.2 THz频率范围内的吸收光谱曲线。每条曲线包含142个光谱特征。由于这些草药的太赫兹吸收光谱没有显着差异，因此很难通过样品的光谱特征来区分样品。需要化学计量算法来解决这个问题。我们选择四种化学计量算法：PCA，SVM，DT和RF。 
3.2 。特征提取
较大数量的样本导致较大数量的输入变量。这意味着更多的冗余信息和计算。PCA用于提取特征以减小输入变量的尺寸。如图4所示，前三台PC占原始数据总贡献的93.68％以上。在三维（3D）分数图中，图5中所示的前三台PC，Herba Solani Nigri的大多数要点与其他要点分开分配。但是，索拉尼草（Herba Solani Lyrati）和马兜铃（Aristolochiae Mollissimae）的许多点混合在一起。这表明前三台PC中包含的信息不足以区分Herba Solani Lyrati和Herba Aristolochiae Mollissimae。其余PC需要更多信息，这些信息占总贡献的6.32％。因此，我们选择了排名前28位的PC进行特征提取。从图4中可以看出，我们提取的特征解释了总贡献的99.99％以上。特征提取后，每个样本的特征从142个减少到28个，输入变量减少了80％以上。
3.3 。分类与评价
为了区分草药，特征提取后，使用具有900个样本的训练集分别创建了SVM模型，DT模型和RF模型。然后，将包含300个样本的测试集的特征输入到分类模型中。如表3所示，RF模型的精度最高。为了更直观，有效地评估区分性能，我们创建了具有不同分类模型的每种草药的ROC曲线（图6）。根据ROC曲线计算AUC值，如表4所示。最大AUC值表示以最高概率正确识别了相应草药的样品，而错误地将其他样品最少地判定为目标。RF模型获得了所有这三种草药的最大AUC值。SVM模型具有与Herba Solani Nigri的RF模型相同的AUC值，但是Herba Solani Lyrati和Herba Aristolochiae Mollissimae的AUC值小于RF模型。DT模型的AUC值最小。基于这些ACU值，可以获得以下评估：
（1）
RF模型对我们工作中的每种草药都有最准确的区分。
（2）
SVM模型与Herba Solani Nigri的RF模型具有相同的判别力。但是，它不足以区分Herba Solani Lyrati和Herba Aristolochiae Mollissimae。
（3）
在我们的工作中，DT模型对所有这三种草药的判别力最差。

4 。结论
在本文中，使用0.2-1.2 THz范围内的PCA-RF可以快速地区分三种草药，并达到99％以上的预测准确性。太赫兹光谱法与化学计量学算法相结合被认为是鉴别传统草药的一种可行而有效的方法。该方法避免了对传统草药检测方法中的个人经验和化学分析中试剂消耗的高要求。尽管获得了很好的辨别力，但是我们对多种草药的研究还不够。需要具有更多种草药的太赫兹波段特征库，这将是一项工作量很大的重要工作。 